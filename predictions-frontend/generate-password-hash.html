<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Generate Password Hash</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #1a1a1e;
      color: #e8e6e3;
    }
    h1 { margin-bottom: 10px; }
    p { color: #9a9a9a; }
    input, button {
      padding: 12px;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #3a3a3f;
      background: #252529;
      color: #e8e6e3;
    }
    input { width: 100%; box-sizing: border-box; margin-bottom: 10px; }
    button {
      cursor: pointer;
      background: #2d2d32;
    }
    button:hover { border-color: #4ade80; }
    pre {
      background: #141416;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      border: 1px solid #3a3a3f;
    }
    .success { color: #4ade80; }
  </style>
</head>
<body>
  <h1>Password Hash Generator</h1>
  <p>Enter a password to generate a salted hash for authStore.svelte.js</p>

  <input type="password" id="password" placeholder="Enter password">
  <button onclick="generate()">Generate Hash</button>

  <div id="output"></div>

  <script>
    function bytesToHex(bytes) {
      return Array.from(bytes)
        .map(b => b.toString(16).padStart(2, '0'))
        .join('')
    }

    async function generate() {
      const password = document.getElementById('password').value
      if (!password) {
        alert('Please enter a password')
        return
      }

      const saltBytes = crypto.getRandomValues(new Uint8Array(16))
      const saltHex = bytesToHex(saltBytes)

      const encoder = new TextEncoder()
      const keyMaterial = await crypto.subtle.importKey(
        'raw',
        encoder.encode(password),
        'PBKDF2',
        false,
        ['deriveBits']
      )

      const derivedBits = await crypto.subtle.deriveBits(
        {
          name: 'PBKDF2',
          salt: saltBytes,
          iterations: 100000,
          hash: 'SHA-256',
        },
        keyMaterial,
        256
      )

      const hashHex = bytesToHex(new Uint8Array(derivedBits))

      const result = {
        salt: saltHex,
        hash: hashHex,
        iterations: 100000,
      }

      document.getElementById('output').innerHTML = `
        <p class="success">Hash generated! Copy this to PASSWORD_HASH in src/lib/authStore.svelte.js:</p>
        <pre>const PASSWORD_HASH = ${JSON.stringify(result, null, 2)}</pre>
      `
    }
  </script>
</body>
</html>
